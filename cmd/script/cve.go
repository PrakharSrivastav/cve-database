package main

import "github.com/PrakharSrivastav/cve-database/store"

type CVERecord struct {
	Type                       string `json:"type"`
	Cve                        string `json:"cve"`
	ResourceID                 string `json:"resourceID"`
	Image                      string `json:"image"`
	ImageID                    string `json:"imageID"`
	Container                  string `json:"container"`
	Host                       string `json:"host"`
	Namespace                  string `json:"namespace"`
	Packages                   string `json:"packages"`
	RiskScore                  string `json:"risk_score"`
	ImpactedPackages           string `json:"impacted_packages"`
	CveDescription             string `json:"cve_description"`
	FactorsNoSecurityProfile   string `json:"factors.noSecurityProfile"`
	FactorsNetwork             string `json:"factors.network"`
	FactorsRootMount           string `json:"factors.rootMount"`
	FactorsHostAccess          string `json:"factors.hostAccess"`
	FactorsRootPrivilege       string `json:"factors.rootPrivilege"`
	FactorsPrivilegedContainer string `json:"factors.privilegedContainer"`
	FactorsEnvVarSecrets       string `json:"factors.envVarSecrets"`
}

func (cve *CVERecord) toDbEntity(runID string) *store.CVEDBRecord {
	return &store.CVEDBRecord{
		RunID:            runID,
		Type:             cve.Type,
		ResourceID:       cve.ResourceID,
		Image:            cve.Image,
		Container:        cve.Container,
		Host:             cve.Host,
		NameSpace:        cve.Namespace,
		Packages:         cve.Packages,
		RiskScore:        cve.RiskScore,
		ImpactedPackages: cve.ImpactedPackages,
		CVEDescription:   cve.CveDescription,
	}
}
